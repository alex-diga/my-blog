---
title: 浏览器地址栏输入url到页面渲染
date: 2022-05-28
---

## 浏览器进程

用户输入内容，进行 URL 解析

1. 如果是文本，则拼接成默认搜索引擎加关键字的 URL 进行搜索
2. 如果是 URL，就进行页面访问请求，并加上协议头（http/https）

## 网络进程

1. 查询缓存，如果命中强缓存则使用本地缓存
2. 如果没有缓存，则进行 DNS 解析,DNS 先查本地、后查运营商、逐级往上查
3. 获取 ip 地址，发起 HTTP 请求。
   - 建立 TCP 三次握手连接
   - 如果协议是 HTTPS，建立 TSL 安全通道连接
   - 发送 HTTP 请求，请求可会到代理服务器或源服务器
4. HTTP 响应
   1. 响应码：100、200、302、404、501
   2. 根据 Content-Type 判断响应文件类型。
      - `text/html`浏览器直接进行解析
      - `image/png`图片类浏览器直接展示

## 渲染进程

页面解析

1. 对 HTML 文本进行词法分析和语法分析构建 DOM 树
2. 样式计算，将 CSS 文本转化为结构化对象 styleSheets
   - 标准化样式属性(格式、单位、大小)
   - 计算每个 DOM 节点的样式，主要是继承和层叠
3. 生成布局树，将生成的 DOM 树和 DOM 样式，通过浏览器的布局系统确定元素的位置
   - 遍历生成的 DOM 树节点，并把它们添加到布局树中
   - 计算布局树节点的坐标位置

页面渲染

1. 建立图层树
   1. 显式合成，由特定CSS属性创建：HTML根元素、position不为static且设置了z-index、opacity值不为1、tramsform值不为none、filter值不为none、isolation值是isolation
   2. 银式合成，层叠等级低的节点被提升为单独的图层后，所有层叠等级比它高的节点都会成为一个单独的图层，可能造成层爆炸
2. 生成绘制列表
3. 生成图块和栅格化，绘制列表准备好后，渲染进程的主线程会给合成线程发送commit信息，把绘制列表提交给合成线程
4. 显示器显示内容

## 重绘和回流


## 参考

1. [神三元-浏览器](https://juejin.cn/post/6844904021308735502#heading-24)
2. [在浏览器地址栏输入一个URL](https://www.zhihu.com/question/34873227)
